.PHONY : po

LINGUAS := de
X_FILES := src/getfacl.c src/setfacl.c src/do_set.c libacl/acl_error.c

all :: $(LINGUAS:%=po/%.mo)

%.mo: %.po
	@if test -n "$(MSGFMT)" ; then \
		echo "$(MSGFMT) -o $@ $<" ; \
		$(MSGFMT) -o $@ $< ; \
	else \
		rm -f $@ ; \
	fi

# xgettext doesn't process C preprocessor statements correctly
# in the version I have, so...

po ::
	( for F in $(X_FILES) ; do \
	  cpp -I. $$F ; done ) | \
	xgettext --omit-header --language=C -o po/acl.pot -
	for CC in $(LINGUAS) ; do \
		msgmerge -o po/$$CC.po po/$$CC.po po/acl.pot ; \
	done

clean ::
	rm -f $(LINGUAS:%=po/%.mo)

distclean ::
	rm -f $(LINGUAS:%=po/%.mo)

install ::
	@for CC in $(LINGUAS) ; do \
		if test -e po/$$CC.mo ; then \
			TO_DIR=$(ROOT)$(gnulocaledir)/$$CC/LC_MESSAGES ; \
			TO_FILE=$$TO_DIR/$(PACKAGE).mo ; \
			$(INSTALL) -d $$TO_DIR ; \
			$(INSTALL) -m 644 po/$$CC.mo $$TO_FILE ; \
		fi ; \
	done

uninstall ::
	@for CC in $(LINGUAS) ; do \
		TO_FILE=$(ROOT)$(gnulocaledir)/$$CC/LC_MESSAGES/$(PACKAGE).mo ; \
		echo $$TO_FILE ; \
		rm -f $$TO_FILE ; \
	done
